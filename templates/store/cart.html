{% extends 'layouts/base.html' %} 

{% load django_bootstrap5 grid_tags static %}

{% block title %}Carrinho{% endblock %}


{% block content %}
<!-- Cart Section -->
<section>
  {% container %}

    {% row %}
    
      {% col 'col-12' %}
        <h3 class="mb-5 text-center">Meu carrinho</h3>
      {% endcol %}

    {% endrow %}
    

    {% if cart_items %}

                    {{ cartitem.cart.get_cart_total }}
      {% row 'gx-3' %}

        {% col 'col-12 col-md-7' %}
          <!-- Cart Items List -->
          <ul class="list-group list-group-lg list-group-flush mb-6">
            {% for item in cart_items %}                
            <li class="list-group-item">
              <div class="row align-items-center">
                <div class="col-3">
                  <!-- Img -->
                  <img class="img-fluid" src="{{ item.pizza.photo_main.url }}" width="128" height="128" alt="Carrinho Item Imagem">
                </div>
                <div class="col">
                  <!-- Product Description -->
                  <div class="d-flex mb-2 fw-bold">
                    <h5 class="text-body">{{ item.pizza.name }}</h5>
                    <span class="ms-auto">{{ item.pizza.price }}</span>
                  </div>
                  <!-- Form Footer -->
                  <div class="d-flex align-items-center">
                    <p class="mt-7 fs-sm text-muted">Qtd:{{ item.quantity }}</p>
                    <a class="fs-xs text-gray-400 ms-auto" href="#">
                      <img src="{% static 'icons/x.svg' %}" width="32" height="32" alt="Carrinho Vazio"> 
                      Excluir
                    </a>
                  </div>
                </div>
              </div>
            </li>
            {% endfor %}

          </ul>
        {% endcol %}

        {% col 'col-12 col-md-5 col-lg-4 offset-lg-1' %}
          <div class="card text-center mb-3 border-0 bg-light">
            <div class="card-body pt-0">
              <h4 class="card-title fs-lg fw-bold mb-3">Resumo</h4>
                <ul class="list-group list-group-sm">
                  {% for item in cart_items %}                
                    <li class="list-group-item d-flex">
                      <span>{{ item.pizza.name }}</span>
                      <span class="ms-auto fs-sm">R$ {{ item.get_cart_item_subtotal }}</span>
                    </li>

                  {% endfor %}
                  
                  
                  <li class="list-group-item d-flex fs-lg fw-bold">
                    <span>Subtotal: R$</span>
                    <span class="ms-auto fs-sm">{{ cart_total }}
                    </span>


                  </li>
                </ul>
              <a class="btn w-100 btn-dark my-4" href="{% url 'store:confirm_cart' %}">Finalizar Carrinho</a>

              <a class="btn btn-link btn-sm px-0 text-body" href="#">Continuar Comprando</a>
            </div>
          </div>

        {% endcol %}

      {% endrow %}

    {% else %}

      {% row 'd-flex justify-content-center' %}

        {% col 'col-md-8 my-2' %}

          <img src="{% static 'icons/cart-x.svg' %}" width="64" height="64" alt="Carrinho Vazio">         
          <h2>Seu carrinho está vazio!</h2>
          <small>Você ainda não possui itens no seu carrinho.</small>
          <a class="btn btn-primary" href="{% url 'store:index' %}">Ver produtos</a>
        {% endcol %}

      {% endrow %}

    {% endif %}

  {% endcontainer %}

</section>

<!-- 

  {% row 'row-cols-1 row-cols-md-2' %}
    {% col 'col-md-8' %}


      <form class="needs-validation" novalidate>
        <div class="table-responsive">
          <table class='table table-sm table-md table-lg table-xl'> 
            <thead>
              <tr>
                <th>Descrição</th>
                <th>Qtd</th>
                <th>Valor</th>
              </tr> 
            </thead>  
            <tbody>
              {% for item in cart_items %}
                <tr>
                  <td>{{ item.pizza.name }}</td> 
                  <td>{{ item.quantity}}</td> 
                  <td>{{ item.pizza.price }}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table> 
          <a class="btn btn-primary" href="{% url 'store:confirm_cart' %}">Finalizar</a>
        </div>
      </form>
    {% endcol %}

    {% col 'col-md-4' %}
      <h4 class="d-flex justify-content-between align-items-center mb-3">
        <span class="text-primary">Seu Carrinho</span>
        <span class="badge bg-primary rounded-pill">3</span>
      </h4>
      <ul class="list-group mb-3">
        <li class="list-group-item d-flex justify-content-between lh-sm">
          <div>
            <h6 class="my-0">Product name</h6>
            <small class="text-body-secondary">Brief description</small>
          </div>
          <span class="text-body-secondary">$12</span>
        </li>
        <li class="list-group-item d-flex justify-content-between lh-sm">
          <div>
            <h6 class="my-0">Second product</h6>
            <small class="text-body-secondary">Brief description</small>
          </div>
          <span class="text-body-secondary">$8</span>
        </li>
        <li class="list-group-item d-flex justify-content-between lh-sm">
          <div>
            <h6 class="my-0">Third item</h6>
            <small class="text-body-secondary">Brief description</small>
          </div>
          <span class="text-body-secondary">$5</span>
        </li>

        <li class="list-group-item d-flex justify-content-between bg-body-tertiary">
          <div class="text-success">
            <h6 class="my-0">Promo code</h6>
            <small>EXAMPLECODE</small>
          </div>
          <span class="text-success">−$5</span>
        </li>

        <li class="list-group-item d-flex justify-content-between">
          <span>Total (USD)</span>
          <strong>$20</strong>
        </li>

        <form class="p-2">
          <div class="input-group">
            <button class="w-50 btn btn-primary btn-lg" type="submit">Continuar</button>
          </div>
        </form>
      </ul>
    {% endcol %}

  {% endrow %}
 -->

{% endblock content %}